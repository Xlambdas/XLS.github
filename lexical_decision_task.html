<!DOCTYPE html>
<html lang="fr">
  <body style="font-size: 48px; text-align: center; margin-top: 100px;">
    <div id="stimulus">Appuyez sur ESPACE pour commencer</div>

    <script>
      const fixationDuration = 500;
      let waitingStart = true;

      const trials = [
        { word: "TABLE", isWord: true },
        { word: "FLORN", isWord: false },
        { word: "ANIMAL", isWord: true },
        { word: "BLERF", isWord: false },
      ];

      let index = 0;
      let startTime = 0;

      function runTrial() {
        if (index >= trials.length) {
          stimulus.innerHTML = "Fin de la démo";
          return;
        }

        // Étape 1 : afficher la croix
        stimulus.innerHTML = "+";

        // Étape 2 : après 500 ms, afficher le stimulus
        setTimeout(() => {
            stimulus.innerHTML = trials[index].word;
            startTime = performance.now();
        }, fixationDuration);
      }

      document.addEventListener("keydown", (e) => {
        // --- Première étape : attente d'un appui sur ESPACE ---
        if (waitingStart && e.code === "Space") {
          waitingStart = false;
          runTrial();
          return;
        }

        if (waitingStart) return; // On ignore tout tant que la tâche n’a pas commencé

        // --- Réponses Left/Right ---
        if (e.key !== "ArrowLeft" && e.key !== "ArrowRight") return;

        const rt = Math.round(performance.now() - startTime);
        const response = (e.key === "ArrowLeft");

        console.log({
          stimulus: trials[index].word,
          correct: response === trials[index].isWord,
          rt: rt
        });

        index++;
        runTrial();
      });
    </script>
  </body>
</html>
